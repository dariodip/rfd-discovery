var getLineNavigatorClass=function(){function e(e,n){var t=this;n=n?n:{};var r=n.encoding?n.encoding:"utf8",i=n.chunkSize?n.chunkSize:4096,o=[],f=new FileWrapper(e,r),a=f.getSize(),s=function(n){return a=a>n?a:f.getSize(e)},l=function(e){var n=s(e);return Math.round(100*e/n)};t.readSomeLines=function(e,n){var a=t.getPlaceToStart(e,o);f.readChunk(a.offset,i,function s(u,g,d){if(u)return n(u,e);var h=d<i,v=t.examineChunk(g,d,h);if(void 0===v)return n("Line "+e+" is out of index, last available: "+(o.length>0?o[o.length-1].lastLine:"none"),e);var c={firstLine:a.firstLine,lastLine:a.firstLine+v.lines-1,offset:a.offset,length:v.length+1};a.isNew&&o.push(c);var p=c.firstLine<=e&&e<=c.lastLine;if(p){var L=0!==a.offset?0:t.getBomOffset(g,r);f.decode(g.slice(L,c.length),function(r){var i=(c.lastLine-c.firstLine+(h?2:1),r.split(t.splitLinesPattern));h||(i=i.slice(0,i.length-1)),e!=c.firstLine&&(i=i.splice(e-c.firstLine)),n(void 0,e,i,h,l(c.offset+c.length),c)})}else{if(h)return n("Line "+e+" is out of index, last available: "+c.lastLine,e);a=t.getPlaceToStart(e,o),f.readChunk(a.offset,i,s)}})},t.readLines=function(e,n,r){if(0===n)return r(void 0,e,[],!1,0);var i=[];t.readSomeLines(e,function o(f,a,l,u,g,d){if(f)return r(f,e);var h=!!u&&a+l.length<=e+n;if(i=i.concat(l),i.length>=n||u){i=i.splice(0,n);var g=t.getProgress(d,e+i.length-1,s(d.offset+d.length));return r(void 0,e,i,h,g)}t.readSomeLines(a+l.length,o)})},t.find=function(e,n,r){t.readSomeLines(n,function n(i,o,f,a,s){if(i)return r(i);for(var l=0;l<f.length;l++){var u=t.searchInLine(e,f[l]);if(u)return r(void 0,o+l,u)}return a?r():void t.readSomeLines(o+f.length+1,n)})},t.findAll=function(e,n,r,i){var o=[];t.readSomeLines(n,function f(a,s,l,u){if(a)return i(a,n);for(var g=0;g<l.length;g++){var d=t.searchInLine(e,l[g]);if(d&&(d.index=s+g,o.push(d),o.length>=r))return i(void 0,n,!0,o)}return u?i(void 0,n,!1,o):void t.readSomeLines(s+l.length,f)})}}e.prototype.splitLinesPattern=/\r\n|\n|\r/,e.prototype.getProgress=function(e,n,t){var r=e.lastLine-e.firstLine+1,i=n-e.firstLine,o=n!==e.lastLine?e.offset+e.length/r*i:e.offset+e.length;return Math.floor(100*(o/t))},e.prototype.searchInLine=function(e,n){var t=e.exec(n);return t?{offset:n.indexOf(t[0]),length:t[0].length,line:n}:null},e.prototype.getPlaceToStart=function(e,n){for(var t=n.length-1;t>=0;t--)if(n[t].lastLine<e)return{firstLine:n[t].lastLine+1,offset:n[t].offset+n[t].length,isNew:t===n.length-1};return{firstLine:0,offset:0,isNew:0===n.length}},e.prototype.getLineEnd=function(e,n,t,r){for(var i="\n".charCodeAt(0),o="\r".charCodeAt(0),f=n;f<t;f++){var a=e[f];if(a===i)return f;if(a===o){var s=f==t-1&&!r;return s?void 0:e[f+1]===i?f+1:f}}},e.prototype.examineChunk=function(n,t,r){var i=0,o=0;do{var f=e.prototype.getLineEnd(n,o,t,r);void 0!==f&&(i++,o=f+1)}while(void 0!==f);return r&&(i++,o=t),o>0?{lines:i,length:o-1}:void 0};var n=[239,187,191],t=[255,254],r=function(e,n){for(var t=0;t<e.length&&t<n.length;t++){if(e[t]!==n[t])return!1;if(t==n.length-1)return!0}return!1};return e.prototype.getBomOffset=function(e,i){switch(i.toLowerCase()){case"utf8":return r(e,n)?n.length:0;case"utf16le":return r(e,t)?t.length:0;default:return 0}},e};if("undefined"!=typeof module&&module.exports)FileWrapper=require("./file-wrapper.min.js"),module.exports=getLineNavigatorClass();else if("function"==typeof define)define(["./file-wrapper.min"],function(e){return FileWrapper=e,getLineNavigatorClass()});else{if("undefined"==typeof FileWrapper)throw"For vanilla JS please add 'file-wrapper.min.js' script tag before this one.";LineNavigator=getLineNavigatorClass()}